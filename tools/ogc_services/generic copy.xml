<tool id="generic" name="Generic" version="0.1.0">
    <description>...</description>
    <stdio> 
        <exit_code range="1:" />
    </stdio>
    <requirements>
        <requirement type="package" version="4.1.2">R</requirement>
        <requirement type="package" version="0.2.3">httr2</requirement>
        <requirement type="package" version="1.2.0">getopt</requirement>
        <requirement type="package" version="1.8.7">jsonlite</requirement>
    </requirements>
    <command><![CDATA[
        Rscript $__tool_directory__/generic.R --file $file    
    ]]>
    </command>
    <inputs>
        <conditional name="select_server">
            <param name="server" type="select" label="Select server">
                <option value="https://ospd.geolabs.fr:8300/ogc-api/">https://ospd.geolabs.fr:8300/ogc-api/1</option>
                <option value="https://ospd.geolabs.fr:8300/ogc-api/2">https://ospd.geolabs.fr:8300/ogc-api/2</option>
                <option value="https://ospd.geolabs.fr:8300/ogc-api/3">https://ospd.geolabs.fr:8300/ogc-api/3</option>
            </param>
            <when value="https://ospd.geolabs.fr:8300/ogc-api/">
                <conditional name="select_process">
                    <param name="process" type="select" label="Select process">
                        <option value="process1">Process 1</option>
                        <option value="process2">Process 2</option>
                        <option value="process3">Process 3</option>
                    </param>
                    <when value="process1">
                        <param name="process1_input1" type="select" label="Select input">
                            <option value="i1">Input 1</option>
                            <option value="i2">Input 2</option>
                            <option value="i3">Input 3</option>
                        </param>
                    </when>
                </conditional>
            </when>
            <when value="https://ospd.geolabs.fr:8300/ogc-api/2">
                <param name="process" type="select" label="Select process">
                    <option value="process4">Process 4</option>
                    <option value="process5">Process 5</option>
                    <option value="process6">Process 6</option>
                </param>
            </when>
            <when value="https://ospd.geolabs.fr:8300/ogc-api/3">
                <param name="process" type="select" label="Select process">
                    <option value="process7">Process 7</option>
                    <option value="process8">Process 8</option>
                    <option value="process9">Process 9</option>
                </param>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="output_data" format="png">
            <change_format>
                <when input="output_format" value="getUrl" format="txt" />
                <when input="output_type" value="tiff" format="tiff" />
                <when input="output_type" value="jpeg" format="jpeg" />
            </change_format>
        </data>
    </outputs>
    <tests>
        <test>
            <!--<output name="galaxy_output" file="/galaxy/tools/mytools/test_data/test_output.txt"/>-->
        </test>
    </tests>
    <help><![CDATA[
        This application performs a mathematical operation on several multi-band images and outputs the result into a monoband image. The given expression is computed at each pixel position. Evaluation of the mathematical formula is done by the muParser libraries.The formula can be written using:  * numerical values ( 2.3, -5, 3.1e4, ...)  * variables containing pixel values (e.g. : 'im2b3' is the pixel value in 2nd image, 3rd band)  * binary operators:    * '+' addition, '-' subtraction, '*' multiplication, '/' division    * '^' raise x to the power of y    * '.
    ]]></help>
    <citations>
        <citation type="bibtex">
            @Manual{,
                title = {httr2: Perform HTTP Requests and Process the Responses},
                author = {Hadley Wickham},
                year = {2023},
                note = {R package version 0.2.3},
                url = {https://CRAN.R-project.org/package=httr2},
            }
        </citation>
    </citations>
</tool>